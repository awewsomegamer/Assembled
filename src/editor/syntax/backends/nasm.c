/**
 * @file main.c
 * @author awewsomegamer <awewsomegamer@gmail.com>
 *
 * @section LICENSE
 *
 * Assembled - Column based text editor
 * Copyright (C) 2023-2024 awewsomegamer
 *
 * This file is apart of Assembled.
 *
 * Assembled is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; version 2
 * of the License.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 *
 * @section DESCRIPTION
 *
 * The main program file
*/
#include <editor/syntax/syntax.h>
#include <editor/buffer/buffer.h>
#include <editor/syntax/backends/nasm.h>

#include <interface/theming/themes.h>

#include <includes.h>
#include <global.h>
#include <string.h>

#ifdef AS_GLIB_ENABLE
	#include <glib-2.0/glib.h>
	static GHashTable *keywords_hash;
#endif

struct AS_Keyword {
	const char *word;
	int color;
};

enum {
	INSTRUCTION = AS_CUSTOM_COLOR_START + 1,
	LABEL,
	COLON,
	SQUARE,
	COMMENT,
	MACRO,
	REGISTER,
	NASM_KEYWORD,
	SYMBOL,
};

static struct keyword keywords[] = {
	{ "DB", NASM_KEYWORD },
	{ "DW", NASM_KEYWORD },
	{ "DD", NASM_KEYWORD },
	{ "DQ", NASM_KEYWORD },
	{ "DT", NASM_KEYWORD },
	{ "DO", NASM_KEYWORD },
	{ "DY", NASM_KEYWORD },
	{ "DZ", NASM_KEYWORD },
	{ "BYTE", NASM_KEYWORD },
	{ "WORD", NASM_KEYWORD },
	{ "DWORD", NASM_KEYWORD },
	{ "QWORD", NASM_KEYWORD },
	{ "TWORD", NASM_KEYWORD },
	{ "OWORD", NASM_KEYWORD },
	{ "YWORD", NASM_KEYWORD },
	{ "ZWORD", NASM_KEYWORD },
	{ "INCBIN", NASM_KEYWORD },
	{ "EQU", NASM_KEYWORD },
	{ "TIMES", NASM_KEYWORD },
	{ "EXTERN", NASM_KEYWORD },
	{ "GLOBAL", NASM_KEYWORD },
	{ "SECTION", NASM_KEYWORD },
	{ "PTR", NASM_KEYWORD},

	{ "RAX", REGISTER },
	{ "RCX", REGISTER },
	{ "RBX", REGISTER },
	{ "RDX", REGISTER },
	{ "EAX", REGISTER },
	{ "ECX", REGISTER },
	{ "EBX", REGISTER },
	{ "EDX", REGISTER },
	{ "AX", REGISTER },
	{ "CX", REGISTER },
	{ "DX", REGISTER },
	{ "BX", REGISTER },
	{ "AL", REGISTER },
	{ "AH", REGISTER },
	{ "CL", REGISTER },
	{ "CH", REGISTER },
	{ "DL", REGISTER },
	{ "DH", REGISTER },
	{ "BL", REGISTER },
	{ "BH", REGISTER },
	{ "R8", REGISTER },
	{ "R9", REGISTER },
	{ "R10", REGISTER },
	{ "R11", REGISTER },
	{ "R12", REGISTER },
	{ "R13", REGISTER },
	{ "R14", REGISTER },
	{ "R15", REGISTER },
	{ "RBP", REGISTER },
	{ "RSP", REGISTER },
	{ "EBP", REGISTER },
	{ "ESP", REGISTER },
	{ "BP", REGISTER },
	{ "SP", REGISTER },
	{ "RDI", REGISTER},
	{ "RSI", REGISTER},
	{ "EDI", REGISTER},
	{ "ESI", REGISTER},
	{ "DI", REGISTER},
	{ "SI", REGISTER},

	{ "AAA", INSTRUCTION },
	{ "AAD", INSTRUCTION },
	{ "AAM", INSTRUCTION },
	{ "AAS", INSTRUCTION },
	{ "ADC", INSTRUCTION },
	{ "ADCX", INSTRUCTION },
	{ "ADD", INSTRUCTION },
	{ "ADDPD", INSTRUCTION },
	{ "ADDPS", INSTRUCTION },
	{ "ADDSD", INSTRUCTION },
	{ "ADDSS", INSTRUCTION },
	{ "ADDSUBPD", INSTRUCTION },
	{ "ADDSUBPS", INSTRUCTION },
	{ "ADOX", INSTRUCTION },
	{ "AESDEC", INSTRUCTION },
	{ "AESDEC128KL", INSTRUCTION },
	{ "AESDEC256KL", INSTRUCTION },
	{ "AESDECLAST", INSTRUCTION },
	{ "AESDECWIDE12", INSTRUCTION },
	{ "AESDECWIDE25", INSTRUCTION },
	{ "AESENC", INSTRUCTION },
	{ "AESENC128KL", INSTRUCTION },
	{ "AESENC256KL", INSTRUCTION },
	{ "AESENCLAST", INSTRUCTION },
	{ "AESENCWIDE12", INSTRUCTION },
	{ "AESENCWIDE25", INSTRUCTION },
	{ "AESIMC", INSTRUCTION },
	{ "AESKEYGENASS", INSTRUCTION },
	{ "AND", INSTRUCTION },
	{ "ANDN", INSTRUCTION },
	{ "ANDNPD", INSTRUCTION },
	{ "ANDNPS", INSTRUCTION },
	{ "ANDPD", INSTRUCTION },
	{ "ANDPS", INSTRUCTION },
	{ "ARPL", INSTRUCTION },
	{ "BEXTR", INSTRUCTION },
	{ "BLENDPD", INSTRUCTION },
	{ "BLENDPS", INSTRUCTION },
	{ "BLENDVPD", INSTRUCTION },
	{ "BLENDVPS", INSTRUCTION },
	{ "BLSI", INSTRUCTION },
	{ "BLSMSK", INSTRUCTION },
	{ "BLSR", INSTRUCTION },
	{ "BNDCL", INSTRUCTION },
	{ "BNDCN", INSTRUCTION },
	{ "BNDCU", INSTRUCTION },
	{ "BNDLDX", INSTRUCTION },
	{ "BNDMK", INSTRUCTION },
	{ "BNDMOV", INSTRUCTION },
	{ "BNDSTX", INSTRUCTION },
	{ "BOUND", INSTRUCTION },
	{ "BSF", INSTRUCTION },
	{ "BSR", INSTRUCTION },
	{ "BSWAP", INSTRUCTION },
	{ "BT", INSTRUCTION },
	{ "BTC", INSTRUCTION },
	{ "BTR", INSTRUCTION },
	{ "BTS", INSTRUCTION },
	{ "BZHI", INSTRUCTION },
	{ "CALL", INSTRUCTION },
	{ "CBW", INSTRUCTION },
	{ "CDQ", INSTRUCTION },
	{ "CDQE", INSTRUCTION },
	{ "CLAC", INSTRUCTION },
	{ "CLC", INSTRUCTION },
	{ "CLD", INSTRUCTION },
	{ "CLDEMOTE", INSTRUCTION },
	{ "CLFLUSH", INSTRUCTION },
	{ "CLFLUSHOPT", INSTRUCTION },
	{ "CLI", INSTRUCTION },
	{ "CLRSSBSY", INSTRUCTION },
	{ "CLTS", INSTRUCTION },
	{ "CLUI", INSTRUCTION },
	{ "CLWB", INSTRUCTION },
	{ "CMC", INSTRUCTION },
	{ "CMOVcc", INSTRUCTION },
	{ "CMP", INSTRUCTION },
	{ "CMPPD", INSTRUCTION },
	{ "CMPPS", INSTRUCTION },
	{ "CMPS", INSTRUCTION },
	{ "CMPSB", INSTRUCTION },
	{ "CMPSD", INSTRUCTION },
	{ "CMPSD", INSTRUCTION },
	{ "CMPSQ", INSTRUCTION },
	{ "CMPSS", INSTRUCTION },
	{ "CMPSW", INSTRUCTION },
	{ "CMPXCHG", INSTRUCTION },
	{ "CMPXCHG16B", INSTRUCTION },
	{ "CMPXCHG8B", INSTRUCTION },
	{ "COMISD", INSTRUCTION },
	{ "COMISS", INSTRUCTION },
	{ "CPUID", INSTRUCTION },
	{ "CQO", INSTRUCTION },
	{ "CRC32", INSTRUCTION },
	{ "CVTDQ2PD", INSTRUCTION },
	{ "CVTDQ2PS", INSTRUCTION },
	{ "CVTPD2DQ", INSTRUCTION },
	{ "CVTPD2PI", INSTRUCTION },
	{ "CVTPD2PS", INSTRUCTION },
	{ "CVTPI2PD", INSTRUCTION },
	{ "CVTPI2PS", INSTRUCTION },
	{ "CVTPS2DQ", INSTRUCTION },
	{ "CVTPS2PD", INSTRUCTION },
	{ "CVTPS2PI", INSTRUCTION },
	{ "CVTSD2SI", INSTRUCTION },
	{ "CVTSD2SS", INSTRUCTION },
	{ "CVTSI2SD", INSTRUCTION },
	{ "CVTSI2SS", INSTRUCTION },
	{ "CVTSS2SD", INSTRUCTION },
	{ "CVTSS2SI", INSTRUCTION },
	{ "CVTTPD2DQ", INSTRUCTION },
	{ "CVTTPD2PI", INSTRUCTION },
	{ "CVTTPS2DQ", INSTRUCTION },
	{ "CVTTPS2PI", INSTRUCTION },
	{ "CVTTSD2SI", INSTRUCTION },
	{ "CVTTSS2SI", INSTRUCTION },
	{ "CWD", INSTRUCTION },
	{ "CWDE", INSTRUCTION },
	{ "DAA", INSTRUCTION },
	{ "DAS", INSTRUCTION },
	{ "DEC", INSTRUCTION },
	{ "DIV", INSTRUCTION },
	{ "DIVPD", INSTRUCTION },
	{ "DIVPS", INSTRUCTION },
	{ "DIVSD", INSTRUCTION },
	{ "DIVSS", INSTRUCTION },
	{ "DPPD", INSTRUCTION },
	{ "DPPS", INSTRUCTION },
	{ "EMMS", INSTRUCTION },
	{ "ENCODEKEY128", INSTRUCTION },
	{ "ENCODEKEY256", INSTRUCTION },
	{ "ENDBR32", INSTRUCTION },
	{ "ENDBR64", INSTRUCTION },
	{ "ENQCMD", INSTRUCTION },
	{ "ENQCMDS", INSTRUCTION },
	{ "ENTER", INSTRUCTION },
	{ "EXTRACTPS", INSTRUCTION },
	{ "F2XM1", INSTRUCTION },
	{ "FABS", INSTRUCTION },
	{ "FADD", INSTRUCTION },
	{ "FADDP", INSTRUCTION },
	{ "FBLD", INSTRUCTION },
	{ "FBSTP", INSTRUCTION },
	{ "FCHS", INSTRUCTION },
	{ "FCLEX", INSTRUCTION },
	{ "FCMOVcc", INSTRUCTION },
	{ "FCOM", INSTRUCTION },
	{ "FCOMI", INSTRUCTION },
	{ "FCOMIP", INSTRUCTION },
	{ "FCOMP", INSTRUCTION },
	{ "FCOMPP", INSTRUCTION },
	{ "FCOS", INSTRUCTION },
	{ "FDECSTP", INSTRUCTION },
	{ "FDIV", INSTRUCTION },
	{ "FDIVP", INSTRUCTION },
	{ "FDIVR", INSTRUCTION },
	{ "FDIVRP", INSTRUCTION },
	{ "FFREE", INSTRUCTION },
	{ "FIADD", INSTRUCTION },
	{ "FICOM", INSTRUCTION },
	{ "FICOMP", INSTRUCTION },
	{ "FIDIV", INSTRUCTION },
	{ "FIDIVR", INSTRUCTION },
	{ "FILD", INSTRUCTION },
	{ "FIMUL", INSTRUCTION },
	{ "FINCSTP", INSTRUCTION },
	{ "FINIT", INSTRUCTION },
	{ "FIST", INSTRUCTION },
	{ "FISTP", INSTRUCTION },
	{ "FISTTP", INSTRUCTION },
	{ "FISUB", INSTRUCTION },
	{ "FISUBR", INSTRUCTION },
	{ "FLD", INSTRUCTION },
	{ "FLD1", INSTRUCTION },
	{ "FLDCW", INSTRUCTION },
	{ "FLDENV", INSTRUCTION },
	{ "FLDL2E", INSTRUCTION },
	{ "FLDL2T", INSTRUCTION },
	{ "FLDLG2", INSTRUCTION },
	{ "FLDLN2", INSTRUCTION },
	{ "FLDPI", INSTRUCTION },
	{ "FLDZ", INSTRUCTION },
	{ "FMUL", INSTRUCTION },
	{ "FMULP", INSTRUCTION },
	{ "FNCLEX", INSTRUCTION },
	{ "FNINIT", INSTRUCTION },
	{ "FNOP", INSTRUCTION },
	{ "FNSAVE", INSTRUCTION },
	{ "FNSTCW", INSTRUCTION },
	{ "FNSTENV", INSTRUCTION },
	{ "FNSTSW", INSTRUCTION },
	{ "FPATAN", INSTRUCTION },
	{ "FPREM", INSTRUCTION },
	{ "FPREM1", INSTRUCTION },
	{ "FPTAN", INSTRUCTION },
	{ "FRNDINT", INSTRUCTION },
	{ "FRSTOR", INSTRUCTION },
	{ "FSAVE", INSTRUCTION },
	{ "FSCALE", INSTRUCTION },
	{ "FSIN", INSTRUCTION },
	{ "FSINCOS", INSTRUCTION },
	{ "FSQRT", INSTRUCTION },
	{ "FST", INSTRUCTION },
	{ "FSTCW", INSTRUCTION },
	{ "FSTENV", INSTRUCTION },
	{ "FSTP", INSTRUCTION },
	{ "FSTSW", INSTRUCTION },
	{ "FSUB", INSTRUCTION },
	{ "FSUBP", INSTRUCTION },
	{ "FSUBR", INSTRUCTION },
	{ "FSUBRP", INSTRUCTION },
	{ "FTST", INSTRUCTION },
	{ "FUCOM", INSTRUCTION },
	{ "FUCOMI", INSTRUCTION },
	{ "FUCOMIP", INSTRUCTION },
	{ "FUCOMP", INSTRUCTION },
	{ "FUCOMPP", INSTRUCTION },
	{ "FWAIT", INSTRUCTION },
	{ "FXAM", INSTRUCTION },
	{ "FXCH", INSTRUCTION },
	{ "FXRSTOR", INSTRUCTION },
	{ "FXSAVE", INSTRUCTION },
	{ "FXTRACT", INSTRUCTION },
	{ "FYL2X", INSTRUCTION },
	{ "FYL2XP1", INSTRUCTION },
	{ "GF2P8AFFINEINVQB", INSTRUCTION },
	{ "GF2P8AFFINEQB", INSTRUCTION },
	{ "GF2P8MULB", INSTRUCTION },
	{ "HADDPD", INSTRUCTION },
	{ "HADDPS", INSTRUCTION },
	{ "HLT", INSTRUCTION },
	{ "HRESET", INSTRUCTION },
	{ "HSUBPD", INSTRUCTION },
	{ "HSUBPS", INSTRUCTION },
	{ "IDIV", INSTRUCTION },
	{ "IMUL", INSTRUCTION },
	{ "IN", INSTRUCTION },
	{ "INC", INSTRUCTION },
	{ "INCSSPD", INSTRUCTION },
	{ "INCSSPQ", INSTRUCTION },
	{ "INS", INSTRUCTION },
	{ "INSB", INSTRUCTION },
	{ "INSD", INSTRUCTION },
	{ "INSERTPS", INSTRUCTION },
	{ "INSW", INSTRUCTION },
	{ "INT", INSTRUCTION },
	{ "INT1", INSTRUCTION },
	{ "INT3", INSTRUCTION },
	{ "INTO", INSTRUCTION },
	{ "INVD", INSTRUCTION },
	{ "INVLPG", INSTRUCTION },
	{ "INVPCID", INSTRUCTION },
	{ "IRET", INSTRUCTION },
	{ "IRETD", INSTRUCTION },
	{ "IRETQ", INSTRUCTION },
	{ "JMP", INSTRUCTION },
	{ "JA", INSTRUCTION },
	{ "JAE", INSTRUCTION },
	{ "JB", INSTRUCTION },
	{ "JBE", INSTRUCTION },
	{ "JC", INSTRUCTION },
	{ "JCXZ", INSTRUCTION },
	{ "JECXZ", INSTRUCTION },
	{ "JRCXZ", INSTRUCTION },
	{ "JE", INSTRUCTION },
	{ "JG", INSTRUCTION },
	{ "JGE", INSTRUCTION },
	{ "JL", INSTRUCTION },
	{ "JLE", INSTRUCTION },
	{ "JNA", INSTRUCTION },
	{ "JNAE", INSTRUCTION },
	{ "JNB", INSTRUCTION },
	{ "JNBE", INSTRUCTION },
	{ "JNC", INSTRUCTION },
	{ "JNE", INSTRUCTION },
	{ "JNG", INSTRUCTION },
	{ "JNGE", INSTRUCTION },
	{ "JNL", INSTRUCTION },
	{ "JNLE", INSTRUCTION },
	{ "JNO", INSTRUCTION },
	{ "JNP", INSTRUCTION },
	{ "JNS", INSTRUCTION },
	{ "JNZ", INSTRUCTION },
	{ "JO", INSTRUCTION },
	{ "JP", INSTRUCTION },
	{ "JPE", INSTRUCTION },
	{ "JPO", INSTRUCTION },
	{ "JS", INSTRUCTION },
	{ "JZ", INSTRUCTION },
	{ "JA", INSTRUCTION },
	{ "JA", INSTRUCTION },
	{ "JAE", INSTRUCTION },
	{ "JAE", INSTRUCTION },
	{ "JB", INSTRUCTION },
	{ "JB", INSTRUCTION },
	{ "JBE", INSTRUCTION },
	{ "JBE", INSTRUCTION },
	{ "JC", INSTRUCTION },
	{ "JC", INSTRUCTION },
	{ "JE", INSTRUCTION },
	{ "JE", INSTRUCTION },
	{ "JZ", INSTRUCTION },
	{ "JZ", INSTRUCTION },
	{ "JG", INSTRUCTION },
	{ "JG", INSTRUCTION },
	{ "JGE", INSTRUCTION },
	{ "JGE", INSTRUCTION },
	{ "JL", INSTRUCTION },
	{ "JL", INSTRUCTION },
	{ "JLE", INSTRUCTION },
	{ "JLE", INSTRUCTION },
	{ "JNA", INSTRUCTION },
	{ "JNA", INSTRUCTION },
	{ "JNAE", INSTRUCTION },
	{ "JNAE", INSTRUCTION },
	{ "JNB", INSTRUCTION },
	{ "JNB", INSTRUCTION },
	{ "JNBE", INSTRUCTION },
	{ "JNBE", INSTRUCTION },
	{ "JNC", INSTRUCTION },
	{ "JNC", INSTRUCTION },
	{ "JNE", INSTRUCTION },
	{ "JNE", INSTRUCTION },
	{ "JNG", INSTRUCTION },
	{ "JNG", INSTRUCTION },
	{ "JNGE", INSTRUCTION },
	{ "JNGE", INSTRUCTION },
	{ "JNL", INSTRUCTION },
	{ "JNL", INSTRUCTION },
	{ "JNLE", INSTRUCTION },
	{ "JNLE", INSTRUCTION },
	{ "JNO", INSTRUCTION },
	{ "JNO", INSTRUCTION },
	{ "JNP", INSTRUCTION },
	{ "JNP", INSTRUCTION },
	{ "JNS", INSTRUCTION },
	{ "JNS", INSTRUCTION },
	{ "JNZ", INSTRUCTION },
	{ "JNZ", INSTRUCTION },
	{ "JO", INSTRUCTION },
	{ "JO", INSTRUCTION },
	{ "JP", INSTRUCTION },
	{ "JP", INSTRUCTION },
	{ "JPE", INSTRUCTION },
	{ "JPE", INSTRUCTION },
	{ "JPO", INSTRUCTION },
	{ "JPO", INSTRUCTION },
	{ "JS", INSTRUCTION },
	{ "JS", INSTRUCTION },
	{ "JZ", INSTRUCTION },
	{ "JZ", INSTRUCTION },
	{ "KADDB", INSTRUCTION },
	{ "KADDD", INSTRUCTION },
	{ "KADDQ", INSTRUCTION },
	{ "KADDW", INSTRUCTION },
	{ "KANDB", INSTRUCTION },
	{ "KANDD", INSTRUCTION },
	{ "KANDNB", INSTRUCTION },
	{ "KANDND", INSTRUCTION },
	{ "KANDNQ", INSTRUCTION },
	{ "KANDNW", INSTRUCTION },
	{ "KANDQ", INSTRUCTION },
	{ "KANDW", INSTRUCTION },
	{ "KMOVB", INSTRUCTION },
	{ "KMOVD", INSTRUCTION },
	{ "KMOVQ", INSTRUCTION },
	{ "KMOVW", INSTRUCTION },
	{ "KNOTB", INSTRUCTION },
	{ "KNOTD", INSTRUCTION },
	{ "KNOTQ", INSTRUCTION },
	{ "KNOTW", INSTRUCTION },
	{ "KORB", INSTRUCTION },
	{ "KORD", INSTRUCTION },
	{ "KORQ", INSTRUCTION },
	{ "KORTESTB", INSTRUCTION },
	{ "KORTESTD", INSTRUCTION },
	{ "KORTESTQ", INSTRUCTION },
	{ "KORTESTW", INSTRUCTION },
	{ "KORW", INSTRUCTION },
	{ "KSHIFTLB", INSTRUCTION },
	{ "KSHIFTLD", INSTRUCTION },
	{ "KSHIFTLQ", INSTRUCTION },
	{ "KSHIFTLW", INSTRUCTION },
	{ "KSHIFTRB", INSTRUCTION },
	{ "KSHIFTRD", INSTRUCTION },
	{ "KSHIFTRQ", INSTRUCTION },
	{ "KSHIFTRW", INSTRUCTION },
	{ "KTESTB", INSTRUCTION },
	{ "KTESTD", INSTRUCTION },
	{ "KTESTQ", INSTRUCTION },
	{ "KTESTW", INSTRUCTION },
	{ "KUNPCKBW", INSTRUCTION },
	{ "KUNPCKDQ", INSTRUCTION },
	{ "KUNPCKWD", INSTRUCTION },
	{ "KXNORB", INSTRUCTION },
	{ "KXNORD", INSTRUCTION },
	{ "KXNORQ", INSTRUCTION },
	{ "KXNORW", INSTRUCTION },
	{ "KXORB", INSTRUCTION },
	{ "KXORD", INSTRUCTION },
	{ "KXORQ", INSTRUCTION },
	{ "KXORW", INSTRUCTION },
	{ "LAHF", INSTRUCTION },
	{ "LAR", INSTRUCTION },
	{ "LDDQU", INSTRUCTION },
	{ "LDMXCSR", INSTRUCTION },
	{ "LDS", INSTRUCTION },
	{ "LDTILECFG", INSTRUCTION },
	{ "LEA", INSTRUCTION },
	{ "LEAVE", INSTRUCTION },
	{ "LES", INSTRUCTION },
	{ "LFENCE", INSTRUCTION },
	{ "LFS", INSTRUCTION },
	{ "LGDT", INSTRUCTION },
	{ "LGS", INSTRUCTION },
	{ "LIDT", INSTRUCTION },
	{ "LLDT", INSTRUCTION },
	{ "LMSW", INSTRUCTION },
	{ "LOADIWKEY", INSTRUCTION },
	{ "LOCK", INSTRUCTION },
	{ "LODS", INSTRUCTION },
	{ "LODSB", INSTRUCTION },
	{ "LODSD", INSTRUCTION },
	{ "LODSQ", INSTRUCTION },
	{ "LODSW", INSTRUCTION },
	{ "LOOP", INSTRUCTION },
	{ "LOOPcc", INSTRUCTION },
	{ "LSL", INSTRUCTION },
	{ "LSS", INSTRUCTION },
	{ "LTR", INSTRUCTION },
	{ "LZCNT", INSTRUCTION },
	{ "MASKMOVDQU", INSTRUCTION },
	{ "MASKMOVQ", INSTRUCTION },
	{ "MAXPD", INSTRUCTION },
	{ "MAXPS", INSTRUCTION },
	{ "MAXSD", INSTRUCTION },
	{ "MAXSS", INSTRUCTION },
	{ "MFENCE", INSTRUCTION },
	{ "MINPD", INSTRUCTION },
	{ "MINPS", INSTRUCTION },
	{ "MINSD", INSTRUCTION },
	{ "MINSS", INSTRUCTION },
	{ "MONITOR", INSTRUCTION },
	{ "MOV", INSTRUCTION },
	{ "MOV", INSTRUCTION },
	{ "MOV", INSTRUCTION },
	{ "MOVAPD", INSTRUCTION },
	{ "MOVAPS", INSTRUCTION },
	{ "MOVBE", INSTRUCTION },
	{ "MOVD", INSTRUCTION },
	{ "MOVDDUP", INSTRUCTION },
	{ "MOVDIR64B", INSTRUCTION },
	{ "MOVDIRI", INSTRUCTION },
	{ "MOVDQ2Q", INSTRUCTION },
	{ "MOVDQA", INSTRUCTION },
	{ "MOVDQU", INSTRUCTION },
	{ "MOVHLPS", INSTRUCTION },
	{ "MOVHPD", INSTRUCTION },
	{ "MOVHPS", INSTRUCTION },
	{ "MOVLHPS", INSTRUCTION },
	{ "MOVLPD", INSTRUCTION },
	{ "MOVLPS", INSTRUCTION },
	{ "MOVMSKPD", INSTRUCTION },
	{ "MOVMSKPS", INSTRUCTION },
	{ "MOVNTDQ", INSTRUCTION },
	{ "MOVNTDQA", INSTRUCTION },
	{ "MOVNTI", INSTRUCTION },
	{ "MOVNTPD", INSTRUCTION },
	{ "MOVNTPS", INSTRUCTION },
	{ "MOVNTQ", INSTRUCTION },
	{ "MOVQ", INSTRUCTION },
	{ "MOVQ", INSTRUCTION },
	{ "MOVQ2DQ", INSTRUCTION },
	{ "MOVS", INSTRUCTION },
	{ "MOVSB", INSTRUCTION },
	{ "MOVSD", INSTRUCTION },
	{ "MOVSD", INSTRUCTION },
	{ "MOVSHDUP", INSTRUCTION },
	{ "MOVSLDUP", INSTRUCTION },
	{ "MOVSQ", INSTRUCTION },
	{ "MOVSS", INSTRUCTION },
	{ "MOVSW", INSTRUCTION },
	{ "MOVSX", INSTRUCTION },
	{ "MOVSXD", INSTRUCTION },
	{ "MOVUPD", INSTRUCTION },
	{ "MOVUPS", INSTRUCTION },
	{ "MOVZX", INSTRUCTION },
	{ "MPSADBW", INSTRUCTION },
	{ "MUL", INSTRUCTION },
	{ "MULPD", INSTRUCTION },
	{ "MULPS", INSTRUCTION },
	{ "MULSD", INSTRUCTION },
	{ "MULSS", INSTRUCTION },
	{ "MULX", INSTRUCTION },
	{ "MWAIT", INSTRUCTION },
	{ "NEG", INSTRUCTION },
	{ "NOP", INSTRUCTION },
	{ "NOT", INSTRUCTION },
	{ "OR", INSTRUCTION },
	{ "ORPD", INSTRUCTION },
	{ "ORPS", INSTRUCTION },
	{ "OUT", INSTRUCTION },
	{ "OUTS", INSTRUCTION },
	{ "OUTSB", INSTRUCTION },
	{ "OUTSD", INSTRUCTION },
	{ "OUTSW", INSTRUCTION },
	{ "PABSB", INSTRUCTION },
	{ "PABSD", INSTRUCTION },
	{ "PABSQ", INSTRUCTION },
	{ "PABSW", INSTRUCTION },
	{ "PACKSSDW", INSTRUCTION },
	{ "PACKSSWB", INSTRUCTION },
	{ "PACKUSDW", INSTRUCTION },
	{ "PACKUSWB", INSTRUCTION },
	{ "PADDB", INSTRUCTION },
	{ "PADDD", INSTRUCTION },
	{ "PADDQ", INSTRUCTION },
	{ "PADDSB", INSTRUCTION },
	{ "PADDSW", INSTRUCTION },
	{ "PADDUSB", INSTRUCTION },
	{ "PADDUSW", INSTRUCTION },
	{ "PADDW", INSTRUCTION },
	{ "PALIGNR", INSTRUCTION },
	{ "PAND", INSTRUCTION },
	{ "PANDN", INSTRUCTION },
	{ "PAUSE", INSTRUCTION },
	{ "PAVGB", INSTRUCTION },
	{ "PAVGW", INSTRUCTION },
	{ "PBLENDVB", INSTRUCTION },
	{ "PBLENDW", INSTRUCTION },
	{ "PCLMULQDQ", INSTRUCTION },
	{ "PCMPEQB", INSTRUCTION },
	{ "PCMPEQD", INSTRUCTION },
	{ "PCMPEQQ", INSTRUCTION },
	{ "PCMPEQW", INSTRUCTION },
	{ "PCMPESTRI", INSTRUCTION },
	{ "PCMPESTRM", INSTRUCTION },
	{ "PCMPGTB", INSTRUCTION },
	{ "PCMPGTD", INSTRUCTION },
	{ "PCMPGTQ", INSTRUCTION },
	{ "PCMPGTW", INSTRUCTION },
	{ "PCMPISTRI", INSTRUCTION },
	{ "PCMPISTRM", INSTRUCTION },
	{ "PCONFIG", INSTRUCTION },
	{ "PDEP", INSTRUCTION },
	{ "PEXT", INSTRUCTION },
	{ "PEXTRB", INSTRUCTION },
	{ "PEXTRD", INSTRUCTION },
	{ "PEXTRQ", INSTRUCTION },
	{ "PEXTRW", INSTRUCTION },
	{ "PHADDD", INSTRUCTION },
	{ "PHADDSW", INSTRUCTION },
	{ "PHADDW", INSTRUCTION },
	{ "PHMINPOSUW", INSTRUCTION },
	{ "PHSUBD", INSTRUCTION },
	{ "PHSUBSW", INSTRUCTION },
	{ "PHSUBW", INSTRUCTION },
	{ "PINSRB", INSTRUCTION },
	{ "PINSRD", INSTRUCTION },
	{ "PINSRQ", INSTRUCTION },
	{ "PINSRW", INSTRUCTION },
	{ "PMADDUBSW", INSTRUCTION },
	{ "PMADDWD", INSTRUCTION },
	{ "PMAXSB", INSTRUCTION },
	{ "PMAXSD", INSTRUCTION },
	{ "PMAXSQ", INSTRUCTION },
	{ "PMAXSW", INSTRUCTION },
	{ "PMAXUB", INSTRUCTION },
	{ "PMAXUD", INSTRUCTION },
	{ "PMAXUQ", INSTRUCTION },
	{ "PMAXUW", INSTRUCTION },
	{ "PMINSB", INSTRUCTION },
	{ "PMINSD", INSTRUCTION },
	{ "PMINSQ", INSTRUCTION },
	{ "PMINSW", INSTRUCTION },
	{ "PMINUB", INSTRUCTION },
	{ "PMINUD", INSTRUCTION },
	{ "PMINUQ", INSTRUCTION },
	{ "PMINUW", INSTRUCTION },
	{ "PMOVMSKB", INSTRUCTION },
	{ "PMOVSX", INSTRUCTION },
	{ "PMOVZX", INSTRUCTION },
	{ "PMULDQ", INSTRUCTION },
	{ "PMULHRSW", INSTRUCTION },
	{ "PMULHUW", INSTRUCTION },
	{ "PMULHW", INSTRUCTION },
	{ "PMULLD", INSTRUCTION },
	{ "PMULLQ", INSTRUCTION },
	{ "PMULLW", INSTRUCTION },
	{ "PMULUDQ", INSTRUCTION },
	{ "POP", INSTRUCTION },
	{ "POPA", INSTRUCTION },
	{ "POPAD", INSTRUCTION },
	{ "POPCNT", INSTRUCTION },
	{ "POPF", INSTRUCTION },
	{ "POPFD", INSTRUCTION },
	{ "POPFQ", INSTRUCTION },
	{ "POR", INSTRUCTION },
	{ "PREFETCHW", INSTRUCTION },
	{ "PREFETCHh", INSTRUCTION },
	{ "PSADBW", INSTRUCTION },
	{ "PSHUFB", INSTRUCTION },
	{ "PSHUFD", INSTRUCTION },
	{ "PSHUFHW", INSTRUCTION },
	{ "PSHUFLW", INSTRUCTION },
	{ "PSHUFW", INSTRUCTION },
	{ "PSIGNB", INSTRUCTION },
	{ "PSIGND", INSTRUCTION },
	{ "PSIGNW", INSTRUCTION },
	{ "PSLLD", INSTRUCTION },
	{ "PSLLDQ", INSTRUCTION },
	{ "PSLLQ", INSTRUCTION },
	{ "PSLLW", INSTRUCTION },
	{ "PSRAD", INSTRUCTION },
	{ "PSRAQ", INSTRUCTION },
	{ "PSRAW", INSTRUCTION },
	{ "PSRLD", INSTRUCTION },
	{ "PSRLDQ", INSTRUCTION },
	{ "PSRLQ", INSTRUCTION },
	{ "PSRLW", INSTRUCTION },
	{ "PSUBB", INSTRUCTION },
	{ "PSUBD", INSTRUCTION },
	{ "PSUBQ", INSTRUCTION },
	{ "PSUBSB", INSTRUCTION },
	{ "PSUBSW", INSTRUCTION },
	{ "PSUBUSB", INSTRUCTION },
	{ "PSUBUSW", INSTRUCTION },
	{ "PSUBW", INSTRUCTION },
	{ "PTEST", INSTRUCTION },
	{ "PTWRITE", INSTRUCTION },
	{ "PUNPCKHBW", INSTRUCTION },
	{ "PUNPCKHDQ", INSTRUCTION },
	{ "PUNPCKHQDQ", INSTRUCTION },
	{ "PUNPCKHWD", INSTRUCTION },
	{ "PUNPCKLBW", INSTRUCTION },
	{ "PUNPCKLDQ", INSTRUCTION },
	{ "PUNPCKLQDQ", INSTRUCTION },
	{ "PUNPCKLWD", INSTRUCTION },
	{ "PUSH", INSTRUCTION },
	{ "PUSHA", INSTRUCTION },
	{ "PUSHAD", INSTRUCTION },
	{ "PUSHF", INSTRUCTION },
	{ "PUSHFD", INSTRUCTION },
	{ "PUSHFQ", INSTRUCTION },
	{ "PXOR", INSTRUCTION },
	{ "RCL", INSTRUCTION },
	{ "RCPPS", INSTRUCTION },
	{ "RCPSS", INSTRUCTION },
	{ "RCR", INSTRUCTION },
	{ "RDFSBASE", INSTRUCTION },
	{ "RDGSBASE", INSTRUCTION },
	{ "RDMSR", INSTRUCTION },
	{ "RDPID", INSTRUCTION },
	{ "RDPKRU", INSTRUCTION },
	{ "RDPMC", INSTRUCTION },
	{ "RDRAND", INSTRUCTION },
	{ "RDSEED", INSTRUCTION },
	{ "RDSSPD", INSTRUCTION },
	{ "RDSSPQ", INSTRUCTION },
	{ "RDTSC", INSTRUCTION },
	{ "RDTSCP", INSTRUCTION },
	{ "REP", INSTRUCTION },
	{ "REPE", INSTRUCTION },
	{ "REPNE", INSTRUCTION },
	{ "REPNZ", INSTRUCTION },
	{ "REPZ", INSTRUCTION },
	{ "RET", INSTRUCTION },
	{ "ROL", INSTRUCTION },
	{ "ROR", INSTRUCTION },
	{ "RORX", INSTRUCTION },
	{ "ROUNDPD", INSTRUCTION },
	{ "ROUNDPS", INSTRUCTION },
	{ "ROUNDSD", INSTRUCTION },
	{ "ROUNDSS", INSTRUCTION },
	{ "RSM", INSTRUCTION },
	{ "RSQRTPS", INSTRUCTION },
	{ "RSQRTSS", INSTRUCTION },
	{ "RSTORSSP", INSTRUCTION },
	{ "SAHF", INSTRUCTION },
	{ "SAL", INSTRUCTION },
	{ "SAR", INSTRUCTION },
	{ "SARX", INSTRUCTION },
	{ "SAVEPREVSSP", INSTRUCTION },
	{ "SBB", INSTRUCTION },
	{ "SCAS", INSTRUCTION },
	{ "SCASB", INSTRUCTION },
	{ "SCASD", INSTRUCTION },
	{ "SCASW", INSTRUCTION },
	{ "SENDUIPI", INSTRUCTION },
	{ "SERIALIZE", INSTRUCTION },
	{ "SETSSBSY", INSTRUCTION },
	{ "SETcc", INSTRUCTION },
	{ "SFENCE", INSTRUCTION },
	{ "SGDT", INSTRUCTION },
	{ "SHA1MSG1", INSTRUCTION },
	{ "SHA1MSG2", INSTRUCTION },
	{ "SHA1NEXTE", INSTRUCTION },
	{ "SHA1RNDS4", INSTRUCTION },
	{ "SHA256MSG1", INSTRUCTION },
	{ "SHA256MSG2", INSTRUCTION },
	{ "SHA256RNDS2", INSTRUCTION },
	{ "SHL", INSTRUCTION },
	{ "SHLD", INSTRUCTION },
	{ "SHLX", INSTRUCTION },
	{ "SHR", INSTRUCTION },
	{ "SHRD", INSTRUCTION },
	{ "SHRX", INSTRUCTION },
	{ "SHUFPD", INSTRUCTION },
	{ "SHUFPS", INSTRUCTION },
	{ "SIDT", INSTRUCTION },
	{ "SLDT", INSTRUCTION },
	{ "SMSW", INSTRUCTION },
	{ "SQRTPD", INSTRUCTION },
	{ "SQRTPS", INSTRUCTION },
	{ "SQRTSD", INSTRUCTION },
	{ "SQRTSS", INSTRUCTION },
	{ "STAC", INSTRUCTION },
	{ "STC", INSTRUCTION },
	{ "STD", INSTRUCTION },
	{ "STI", INSTRUCTION },
	{ "STMXCSR", INSTRUCTION },
	{ "STOS", INSTRUCTION },
	{ "STOSB", INSTRUCTION },
	{ "STOSD", INSTRUCTION },
	{ "STOSQ", INSTRUCTION },
	{ "STOSW", INSTRUCTION },
	{ "STR", INSTRUCTION },
	{ "STTILECFG", INSTRUCTION },
	{ "STUI", INSTRUCTION },
	{ "SUB", INSTRUCTION },
	{ "SUBPD", INSTRUCTION },
	{ "SUBPS", INSTRUCTION },
	{ "SUBSD", INSTRUCTION },
	{ "SUBSS", INSTRUCTION },
	{ "SWAPGS", INSTRUCTION },
	{ "SYSCALL", INSTRUCTION },
	{ "SYSENTER", INSTRUCTION },
	{ "SYSEXIT", INSTRUCTION },
	{ "SYSRET", INSTRUCTION },
	{ "TDPBF16PS", INSTRUCTION },
	{ "TDPBSSD", INSTRUCTION },
	{ "TDPBSUD", INSTRUCTION },
	{ "TDPBUSD", INSTRUCTION },
	{ "TDPBUUD", INSTRUCTION },
	{ "TEST", INSTRUCTION },
	{ "TESTUI", INSTRUCTION },
	{ "TILELOADD", INSTRUCTION },
	{ "TILELOADDT1", INSTRUCTION },
	{ "TILERELEASE", INSTRUCTION },
	{ "TILESTORED", INSTRUCTION },
	{ "TILEZERO", INSTRUCTION },
	{ "TPAUSE", INSTRUCTION },
	{ "TZCNT", INSTRUCTION },
	{ "UCOMISD", INSTRUCTION },
	{ "UCOMISS", INSTRUCTION },
	{ "UD", INSTRUCTION },
	{ "UIRET", INSTRUCTION },
	{ "UMONITOR", INSTRUCTION },
	{ "UMWAIT", INSTRUCTION },
	{ "UNPCKHPD", INSTRUCTION },
	{ "UNPCKHPS", INSTRUCTION },
	{ "UNPCKLPD", INSTRUCTION },
	{ "UNPCKLPS", INSTRUCTION },
	{ "VADDPH", INSTRUCTION },
	{ "VADDSH", INSTRUCTION },
	{ "VALIGND", INSTRUCTION },
	{ "VALIGNQ", INSTRUCTION },
	{ "VBLENDMPD", INSTRUCTION },
	{ "VBLENDMPS", INSTRUCTION },
	{ "VBROADCAST", INSTRUCTION },
	{ "VCMPPH", INSTRUCTION },
	{ "VCMPSH", INSTRUCTION },
	{ "VCOMISH", INSTRUCTION },
	{ "VCOMPRESSPD", INSTRUCTION },
	{ "VCOMPRESSPS", INSTRUCTION },
	{ "VCOMPRESSW", INSTRUCTION },
	{ "VCVTDQ2PH", INSTRUCTION },
	{ "VCVTNE2PS2BF16", INSTRUCTION },
	{ "VCVTNEPS2BF16", INSTRUCTION },
	{ "VCVTPD2PH", INSTRUCTION },
	{ "VCVTPD2QQ", INSTRUCTION },
	{ "VCVTPD2UDQ", INSTRUCTION },
	{ "VCVTPD2UQQ", INSTRUCTION },
	{ "VCVTPH2DQ", INSTRUCTION },
	{ "VCVTPH2PD", INSTRUCTION },
	{ "VCVTPH2PS", INSTRUCTION },
	{ "VCVTPH2PSX", INSTRUCTION },
	{ "VCVTPH2QQ", INSTRUCTION },
	{ "VCVTPH2UDQ", INSTRUCTION },
	{ "VCVTPH2UQQ", INSTRUCTION },
	{ "VCVTPH2UW", INSTRUCTION },
	{ "VCVTPH2W", INSTRUCTION },
	{ "VCVTPS2PH", INSTRUCTION },
	{ "VCVTPS2PHX", INSTRUCTION },
	{ "VCVTPS2QQ", INSTRUCTION },
	{ "VCVTPS2UDQ", INSTRUCTION },
	{ "VCVTPS2UQQ", INSTRUCTION },
	{ "VCVTQQ2PD", INSTRUCTION },
	{ "VCVTQQ2PH", INSTRUCTION },
	{ "VCVTQQ2PS", INSTRUCTION },
	{ "VCVTSD2SH", INSTRUCTION },
	{ "VCVTSD2USI", INSTRUCTION },
	{ "VCVTSH2SD", INSTRUCTION },
	{ "VCVTSH2SI", INSTRUCTION },
	{ "VCVTSH2SS", INSTRUCTION },
	{ "VCVTSH2USI", INSTRUCTION },
	{ "VCVTSI2SH", INSTRUCTION },
	{ "VCVTSS2SH", INSTRUCTION },
	{ "VCVTSS2USI", INSTRUCTION },
	{ "VCVTTPD2QQ", INSTRUCTION },
	{ "VCVTTPD2UDQ", INSTRUCTION },
	{ "VCVTTPD2UQQ", INSTRUCTION },
	{ "VCVTTPH2DQ", INSTRUCTION },
	{ "VCVTTPH2QQ", INSTRUCTION },
	{ "VCVTTPH2UDQ", INSTRUCTION },
	{ "VCVTTPH2UQQ", INSTRUCTION },
	{ "VCVTTPH2UW", INSTRUCTION },
	{ "VCVTTPH2W", INSTRUCTION },
	{ "VCVTTPS2QQ", INSTRUCTION },
	{ "VCVTTPS2UDQ", INSTRUCTION },
	{ "VCVTTPS2UQQ", INSTRUCTION },
	{ "VCVTTSD2USI", INSTRUCTION },
	{ "VCVTTSH2SI", INSTRUCTION },
	{ "VCVTTSH2USI", INSTRUCTION },
	{ "VCVTTSS2USI", INSTRUCTION },
	{ "VCVTUDQ2PD", INSTRUCTION },
	{ "VCVTUDQ2PH", INSTRUCTION },
	{ "VCVTUDQ2PS", INSTRUCTION },
	{ "VCVTUQQ2PD", INSTRUCTION },
	{ "VCVTUQQ2PH", INSTRUCTION },
	{ "VCVTUQQ2PS", INSTRUCTION },
	{ "VCVTUSI2SD", INSTRUCTION },
	{ "VCVTUSI2SH", INSTRUCTION },
	{ "VCVTUSI2SS", INSTRUCTION },
	{ "VCVTUW2PH", INSTRUCTION },
	{ "VCVTW2PH", INSTRUCTION },
	{ "VDBPSADBW", INSTRUCTION },
	{ "VDIVPH", INSTRUCTION },
	{ "VDIVSH", INSTRUCTION },
	{ "VDPBF16PS", INSTRUCTION },
	{ "VERR", INSTRUCTION },
	{ "VERW", INSTRUCTION },
	{ "VEXPANDPD", INSTRUCTION },
	{ "VEXPANDPS", INSTRUCTION },
	{ "VEXTRACTF128", INSTRUCTION },
	{ "VEXTRACTF32x4", INSTRUCTION },
	{ "VEXTRACTF32x8", INSTRUCTION },
	{ "VEXTRACTF64x2", INSTRUCTION },
	{ "VEXTRACTF64x4", INSTRUCTION },
	{ "VEXTRACTI128", INSTRUCTION },
	{ "VEXTRACTI32x4", INSTRUCTION },
	{ "VEXTRACTI32x8", INSTRUCTION },
	{ "VEXTRACTI64x2", INSTRUCTION },
	{ "VEXTRACTI64x4", INSTRUCTION },
	{ "VFCMADDCPH", INSTRUCTION },
	{ "VFCMADDCSH", INSTRUCTION },
	{ "VFCMULCPH", INSTRUCTION },
	{ "VFCMULCSH", INSTRUCTION },
	{ "VFIXUPIMMPD", INSTRUCTION },
	{ "VFIXUPIMMPS", INSTRUCTION },
	{ "VFIXUPIMMSD", INSTRUCTION },
	{ "VFIXUPIMMSS", INSTRUCTION },
	{ "VFMADD132PD", INSTRUCTION },
	{ "VFMADD132PH", INSTRUCTION },
	{ "VFMADD132PS", INSTRUCTION },
	{ "VFMADD132SD", INSTRUCTION },
	{ "VFMADD132SH", INSTRUCTION },
	{ "VFMADD132SS", INSTRUCTION },
	{ "VFMADD213PD", INSTRUCTION },
	{ "VFMADD213PH", INSTRUCTION },
	{ "VFMADD213PS", INSTRUCTION },
	{ "VFMADD213SD", INSTRUCTION },
	{ "VFMADD213SH", INSTRUCTION },
	{ "VFMADD213SS", INSTRUCTION },
	{ "VFMADD231PD", INSTRUCTION },
	{ "VFMADD231PH", INSTRUCTION },
	{ "VFMADD231PS", INSTRUCTION },
	{ "VFMADD231SD", INSTRUCTION },
	{ "VFMADD231SH", INSTRUCTION },
	{ "VFMADD231SS", INSTRUCTION },
	{ "VFMADDCPH", INSTRUCTION },
	{ "VFMADDCSH", INSTRUCTION },
	{ "VFMADDSUB132PD", INSTRUCTION },
	{ "VFMADDSUB132PH", INSTRUCTION },
	{ "VFMADDSUB132PS", INSTRUCTION },
	{ "VFMADDSUB213PD", INSTRUCTION },
	{ "VFMADDSUB213PH", INSTRUCTION },
	{ "VFMADDSUB213PS", INSTRUCTION },
	{ "VFMADDSUB231PD", INSTRUCTION },
	{ "VFMADDSUB231PH", INSTRUCTION },
	{ "VFMADDSUB231PS", INSTRUCTION },
	{ "VFMSUB132PD", INSTRUCTION },
	{ "VFMSUB132PH", INSTRUCTION },
	{ "VFMSUB132PS", INSTRUCTION },
	{ "VFMSUB132SD", INSTRUCTION },
	{ "VFMSUB132SH", INSTRUCTION },
	{ "VFMSUB132SS", INSTRUCTION },
	{ "VFMSUB213PD", INSTRUCTION },
	{ "VFMSUB213PH", INSTRUCTION },
	{ "VFMSUB213PS", INSTRUCTION },
	{ "VFMSUB213SD", INSTRUCTION },
	{ "VFMSUB213SH", INSTRUCTION },
	{ "VFMSUB213SS", INSTRUCTION },
	{ "VFMSUB231PD", INSTRUCTION },
	{ "VFMSUB231PH", INSTRUCTION },
	{ "VFMSUB231PS", INSTRUCTION },
	{ "VFMSUB231SD", INSTRUCTION },
	{ "VFMSUB231SH", INSTRUCTION },
	{ "VFMSUB231SS", INSTRUCTION },
	{ "VFMSUBADD132PD", INSTRUCTION },
	{ "VFMSUBADD132PH", INSTRUCTION },
	{ "VFMSUBADD132PS", INSTRUCTION },
	{ "VFMSUBADD213PD", INSTRUCTION },
	{ "VFMSUBADD213PH", INSTRUCTION },
	{ "VFMSUBADD213PS", INSTRUCTION },
	{ "VFMSUBADD231PD", INSTRUCTION },
	{ "VFMSUBADD231PH", INSTRUCTION },
	{ "VFMSUBADD231PS", INSTRUCTION },
	{ "VFMULCPH", INSTRUCTION },
	{ "VFMULCSH", INSTRUCTION },
	{ "VFNMADD132PD", INSTRUCTION },
	{ "VFNMADD132PH", INSTRUCTION },
	{ "VFNMADD132PS", INSTRUCTION },
	{ "VFNMADD132SD", INSTRUCTION },
	{ "VFNMADD132SH", INSTRUCTION },
	{ "VFNMADD132SS", INSTRUCTION },
	{ "VFNMADD213PD", INSTRUCTION },
	{ "VFNMADD213PH", INSTRUCTION },
	{ "VFNMADD213PS", INSTRUCTION },
	{ "VFNMADD213SD", INSTRUCTION },
	{ "VFNMADD213SH", INSTRUCTION },
	{ "VFNMADD213SS", INSTRUCTION },
	{ "VFNMADD231PD", INSTRUCTION },
	{ "VFNMADD231PH", INSTRUCTION },
	{ "VFNMADD231PS", INSTRUCTION },
	{ "VFNMADD231SD", INSTRUCTION },
	{ "VFNMADD231SH", INSTRUCTION },
	{ "VFNMADD231SS", INSTRUCTION },
	{ "VFNMSUB132PD", INSTRUCTION },
	{ "VFNMSUB132PH", INSTRUCTION },
	{ "VFNMSUB132PS", INSTRUCTION },
	{ "VFNMSUB132SD", INSTRUCTION },
	{ "VFNMSUB132SH", INSTRUCTION },
	{ "VFNMSUB132SS", INSTRUCTION },
	{ "VFNMSUB213PD", INSTRUCTION },
	{ "VFNMSUB213PH", INSTRUCTION },
	{ "VFNMSUB213PS", INSTRUCTION },
	{ "VFNMSUB213SD", INSTRUCTION },
	{ "VFNMSUB213SH", INSTRUCTION },
	{ "VFNMSUB213SS", INSTRUCTION },
	{ "VFNMSUB231PD", INSTRUCTION },
	{ "VFNMSUB231PH", INSTRUCTION },
	{ "VFNMSUB231PS", INSTRUCTION },
	{ "VFNMSUB231SD", INSTRUCTION },
	{ "VFNMSUB231SH", INSTRUCTION },
	{ "VFNMSUB231SS", INSTRUCTION },
	{ "VFPCLASSPD", INSTRUCTION },
	{ "VFPCLASSPH", INSTRUCTION },
	{ "VFPCLASSPS", INSTRUCTION },
	{ "VFPCLASSSD", INSTRUCTION },
	{ "VFPCLASSSH", INSTRUCTION },
	{ "VFPCLASSSS", INSTRUCTION },
	{ "VGATHERDPD", INSTRUCTION },
	{ "VGATHERDPD", INSTRUCTION },
	{ "VGATHERDPS", INSTRUCTION },
	{ "VGATHERDPS", INSTRUCTION },
	{ "VGATHERQPD", INSTRUCTION },
	{ "VGATHERQPD", INSTRUCTION },
	{ "VGATHERQPS", INSTRUCTION },
	{ "VGATHERQPS", INSTRUCTION },
	{ "VGETEXPPD", INSTRUCTION },
	{ "VGETEXPPH", INSTRUCTION },
	{ "VGETEXPPS", INSTRUCTION },
	{ "VGETEXPSD", INSTRUCTION },
	{ "VGETEXPSH", INSTRUCTION },
	{ "VGETEXPSS", INSTRUCTION },
	{ "VGETMANTPD", INSTRUCTION },
	{ "VGETMANTPH", INSTRUCTION },
	{ "VGETMANTPS", INSTRUCTION },
	{ "VGETMANTSD", INSTRUCTION },
	{ "VGETMANTSH", INSTRUCTION },
	{ "VGETMANTSS", INSTRUCTION },
	{ "VINSERTF128", INSTRUCTION },
	{ "VINSERTF32x4", INSTRUCTION },
	{ "VINSERTF32x8", INSTRUCTION },
	{ "VINSERTF64x2", INSTRUCTION },
	{ "VINSERTF64x4", INSTRUCTION },
	{ "VINSERTI128", INSTRUCTION },
	{ "VINSERTI32x4", INSTRUCTION },
	{ "VINSERTI32x8", INSTRUCTION },
	{ "VINSERTI64x2", INSTRUCTION },
	{ "VINSERTI64x4", INSTRUCTION },
	{ "VMASKMOV", INSTRUCTION },
	{ "VMAXPH", INSTRUCTION },
	{ "VMAXSH", INSTRUCTION },
	{ "VMINPH", INSTRUCTION },
	{ "VMINSH", INSTRUCTION },
	{ "VMOVDQA32", INSTRUCTION },
	{ "VMOVDQA64", INSTRUCTION },
	{ "VMOVDQU16", INSTRUCTION },
	{ "VMOVDQU32", INSTRUCTION },
	{ "VMOVDQU64", INSTRUCTION },
	{ "VMOVDQU8", INSTRUCTION },
	{ "VMOVSH", INSTRUCTION },
	{ "VMOVW", INSTRUCTION },
	{ "VMULPH", INSTRUCTION },
	{ "VMULSH", INSTRUCTION },
	{ "VP2INTERSECTD", INSTRUCTION },
	{ "VP2INTERSECTQ", INSTRUCTION },
	{ "VPBLENDD", INSTRUCTION },
	{ "VPBLENDMB", INSTRUCTION },
	{ "VPBLENDMD", INSTRUCTION },
	{ "VPBLENDMQ", INSTRUCTION },
	{ "VPBLENDMW", INSTRUCTION },
	{ "VPBROADCAST", INSTRUCTION },
	{ "VPBROADCASTB", INSTRUCTION },
	{ "VPBROADCASTD", INSTRUCTION },
	{ "VPBROADCASTM", INSTRUCTION },
	{ "VPBROADCASTQ", INSTRUCTION },
	{ "VPBROADCASTW", INSTRUCTION },
	{ "VPCMPB", INSTRUCTION },
	{ "VPCMPD", INSTRUCTION },
	{ "VPCMPQ", INSTRUCTION },
	{ "VPCMPUB", INSTRUCTION },
	{ "VPCMPUD", INSTRUCTION },
	{ "VPCMPUQ", INSTRUCTION },
	{ "VPCMPUW", INSTRUCTION },
	{ "VPCMPW", INSTRUCTION },
	{ "VPCOMPRESSB", INSTRUCTION },
	{ "VPCOMPRESSD", INSTRUCTION },
	{ "VPCOMPRESSQ", INSTRUCTION },
	{ "VPCONFLICTD", INSTRUCTION },
	{ "VPCONFLICTQ", INSTRUCTION },
	{ "VPDPBUSD", INSTRUCTION },
	{ "VPDPBUSDS", INSTRUCTION },
	{ "VPDPWSSD", INSTRUCTION },
	{ "VPDPWSSDS", INSTRUCTION },
	{ "VPERM2F128", INSTRUCTION },
	{ "VPERM2I128", INSTRUCTION },
	{ "VPERMB", INSTRUCTION },
	{ "VPERMD", INSTRUCTION },
	{ "VPERMI2B", INSTRUCTION },
	{ "VPERMI2D", INSTRUCTION },
	{ "VPERMI2PD", INSTRUCTION },
	{ "VPERMI2PS", INSTRUCTION },
	{ "VPERMI2Q", INSTRUCTION },
	{ "VPERMI2W", INSTRUCTION },
	{ "VPERMILPD", INSTRUCTION },
	{ "VPERMILPS", INSTRUCTION },
	{ "VPERMPD", INSTRUCTION },
	{ "VPERMPS", INSTRUCTION },
	{ "VPERMQ", INSTRUCTION },
	{ "VPERMT2B", INSTRUCTION },
	{ "VPERMT2D", INSTRUCTION },
	{ "VPERMT2PD", INSTRUCTION },
	{ "VPERMT2PS", INSTRUCTION },
	{ "VPERMT2Q", INSTRUCTION },
	{ "VPERMT2W", INSTRUCTION },
	{ "VPERMW", INSTRUCTION },
	{ "VPEXPANDB", INSTRUCTION },
	{ "VPEXPANDD", INSTRUCTION },
	{ "VPEXPANDQ", INSTRUCTION },
	{ "VPEXPANDW", INSTRUCTION },
	{ "VPGATHERDD", INSTRUCTION },
	{ "VPGATHERDD", INSTRUCTION },
	{ "VPGATHERDQ", INSTRUCTION },
	{ "VPGATHERDQ", INSTRUCTION },
	{ "VPGATHERQD", INSTRUCTION },
	{ "VPGATHERQD", INSTRUCTION },
	{ "VPGATHERQQ", INSTRUCTION },
	{ "VPGATHERQQ", INSTRUCTION },
	{ "VPLZCNTD", INSTRUCTION },
	{ "VPLZCNTQ", INSTRUCTION },
	{ "VPMADD52HUQ", INSTRUCTION },
	{ "VPMADD52LUQ", INSTRUCTION },
	{ "VPMASKMOV", INSTRUCTION },
	{ "VPMOVB2M", INSTRUCTION },
	{ "VPMOVD2M", INSTRUCTION },
	{ "VPMOVDB", INSTRUCTION },
	{ "VPMOVDW", INSTRUCTION },
	{ "VPMOVM2B", INSTRUCTION },
	{ "VPMOVM2D", INSTRUCTION },
	{ "VPMOVM2Q", INSTRUCTION },
	{ "VPMOVM2W", INSTRUCTION },
	{ "VPMOVQ2M", INSTRUCTION },
	{ "VPMOVQB", INSTRUCTION },
	{ "VPMOVQD", INSTRUCTION },
	{ "VPMOVQW", INSTRUCTION },
	{ "VPMOVSDB", INSTRUCTION },
	{ "VPMOVSDW", INSTRUCTION },
	{ "VPMOVSQB", INSTRUCTION },
	{ "VPMOVSQD", INSTRUCTION },
	{ "VPMOVSQW", INSTRUCTION },
	{ "VPMOVSWB", INSTRUCTION },
	{ "VPMOVUSDB", INSTRUCTION },
	{ "VPMOVUSDW", INSTRUCTION },
	{ "VPMOVUSQB", INSTRUCTION },
	{ "VPMOVUSQD", INSTRUCTION },
	{ "VPMOVUSQW", INSTRUCTION },
	{ "VPMOVUSWB", INSTRUCTION },
	{ "VPMOVW2M", INSTRUCTION },
	{ "VPMOVWB", INSTRUCTION },
	{ "VPMULTISHIFTQB", INSTRUCTION },
	{ "VPOPCNT", INSTRUCTION },
	{ "VPROLD", INSTRUCTION },
	{ "VPROLQ", INSTRUCTION },
	{ "VPROLVD", INSTRUCTION },
	{ "VPROLVQ", INSTRUCTION },
	{ "VPRORD", INSTRUCTION },
	{ "VPRORQ", INSTRUCTION },
	{ "VPRORVD", INSTRUCTION },
	{ "VPRORVQ", INSTRUCTION },
	{ "VPSCATTERDD", INSTRUCTION },
	{ "VPSCATTERDQ", INSTRUCTION },
	{ "VPSCATTERQD", INSTRUCTION },
	{ "VPSCATTERQQ", INSTRUCTION },
	{ "VPSHLD", INSTRUCTION },
	{ "VPSHLDV", INSTRUCTION },
	{ "VPSHRD", INSTRUCTION },
	{ "VPSHRDV", INSTRUCTION },
	{ "VPSHUFBITQMB", INSTRUCTION },
	{ "VPSLLVD", INSTRUCTION },
	{ "VPSLLVQ", INSTRUCTION },
	{ "VPSLLVW", INSTRUCTION },
	{ "VPSRAVD", INSTRUCTION },
	{ "VPSRAVQ", INSTRUCTION },
	{ "VPSRAVW", INSTRUCTION },
	{ "VPSRLVD", INSTRUCTION },
	{ "VPSRLVQ", INSTRUCTION },
	{ "VPSRLVW", INSTRUCTION },
	{ "VPTERNLOGD", INSTRUCTION },
	{ "VPTERNLOGQ", INSTRUCTION },
	{ "VPTESTMB", INSTRUCTION },
	{ "VPTESTMD", INSTRUCTION },
	{ "VPTESTMQ", INSTRUCTION },
	{ "VPTESTMW", INSTRUCTION },
	{ "VPTESTNMB", INSTRUCTION },
	{ "VPTESTNMD", INSTRUCTION },
	{ "VPTESTNMQ", INSTRUCTION },
	{ "VPTESTNMW", INSTRUCTION },
	{ "VRANGEPD", INSTRUCTION },
	{ "VRANGEPS", INSTRUCTION },
	{ "VRANGESD", INSTRUCTION },
	{ "VRANGESS", INSTRUCTION },
	{ "VRCP14PD", INSTRUCTION },
	{ "VRCP14PS", INSTRUCTION },
	{ "VRCP14SD", INSTRUCTION },
	{ "VRCP14SS", INSTRUCTION },
	{ "VRCPPH", INSTRUCTION },
	{ "VRCPSH", INSTRUCTION },
	{ "VREDUCEPD", INSTRUCTION },
	{ "VREDUCEPH", INSTRUCTION },
	{ "VREDUCEPS", INSTRUCTION },
	{ "VREDUCESD", INSTRUCTION },
	{ "VREDUCESH", INSTRUCTION },
	{ "VREDUCESS", INSTRUCTION },
	{ "VRNDSCALEPD", INSTRUCTION },
	{ "VRNDSCALEPH", INSTRUCTION },
	{ "VRNDSCALEPS", INSTRUCTION },
	{ "VRNDSCALESD", INSTRUCTION },
	{ "VRNDSCALESH", INSTRUCTION },
	{ "VRNDSCALESS", INSTRUCTION },
	{ "VRSQRT14PD", INSTRUCTION },
	{ "VRSQRT14PS", INSTRUCTION },
	{ "VRSQRT14SD", INSTRUCTION },
	{ "VRSQRT14SS", INSTRUCTION },
	{ "VRSQRTPH", INSTRUCTION },
	{ "VRSQRTSH", INSTRUCTION },
	{ "VSCALEFPD", INSTRUCTION },
	{ "VSCALEFPH", INSTRUCTION },
	{ "VSCALEFPS", INSTRUCTION },
	{ "VSCALEFSD", INSTRUCTION },
	{ "VSCALEFSH", INSTRUCTION },
	{ "VSCALEFSS", INSTRUCTION },
	{ "VSCATTERDPD", INSTRUCTION },
	{ "VSCATTERDPS", INSTRUCTION },
	{ "VSCATTERQPD", INSTRUCTION },
	{ "VSCATTERQPS", INSTRUCTION },
	{ "VSHUFF32x4", INSTRUCTION },
	{ "VSHUFF64x2", INSTRUCTION },
	{ "VSHUFI32x4", INSTRUCTION },
	{ "VSHUFI64x2", INSTRUCTION },
	{ "VSQRTPH", INSTRUCTION },
	{ "VSQRTSH", INSTRUCTION },
	{ "VSUBPH", INSTRUCTION },
	{ "VSUBSH", INSTRUCTION },
	{ "VTESTPD", INSTRUCTION },
	{ "VTESTPS", INSTRUCTION },
	{ "VUCOMISH", INSTRUCTION },
	{ "VZEROALL", INSTRUCTION },
	{ "VZEROUPPER", INSTRUCTION },
	{ "WAIT", INSTRUCTION },
	{ "WBINVD", INSTRUCTION },
	{ "WBNOINVD", INSTRUCTION },
	{ "WRFSBASE", INSTRUCTION },
	{ "WRGSBASE", INSTRUCTION },
	{ "WRMSR", INSTRUCTION },
	{ "WRPKRU", INSTRUCTION },
	{ "WRSSD", INSTRUCTION },
	{ "WRSSQ", INSTRUCTION },
	{ "WRUSSD", INSTRUCTION },
	{ "WRUSSQ", INSTRUCTION },
	{ "XABORT", INSTRUCTION },
	{ "XACQUIRE", INSTRUCTION },
	{ "XADD", INSTRUCTION },
	{ "XBEGIN", INSTRUCTION },
	{ "XCHG", INSTRUCTION },
	{ "XEND", INSTRUCTION },
	{ "XGETBV", INSTRUCTION },
	{ "XLAT", INSTRUCTION },
	{ "XLATB", INSTRUCTION },
	{ "XOR", INSTRUCTION },
	{ "XORPD", INSTRUCTION },
	{ "XORPS", INSTRUCTION },
	{ "XRELEASE", INSTRUCTION },
	{ "XRESLDTRK", INSTRUCTION },
	{ "XRSTOR", INSTRUCTION },
	{ "XRSTORS", INSTRUCTION },
	{ "XSAVE", INSTRUCTION },
	{ "XSAVEC", INSTRUCTION },
	{ "XSAVEOPT", INSTRUCTION },
	{ "XSAVES", INSTRUCTION },
	{ "XSETBV", INSTRUCTION },
	{ "XSUSLDTRK", INSTRUCTION },
	{ "XTEST", INSTRUCTION },

	{ "GETSEC[CAPABILITIES]", INSTRUCTION },
	{ "GETSEC[ENTERACCS]", INSTRUCTION },
	{ "GETSEC[EXITAC]", INSTRUCTION },
	{ "GETSEC[PARAMETERS]", INSTRUCTION },
	{ "GETSEC[SENTER]", INSTRUCTION },
	{ "GETSEC[SEXIT]", INSTRUCTION },
	{ "GETSEC[SMCTRL]", INSTRUCTION },
	{ "GETSEC[WAKEUP]", INSTRUCTION },

	{ "INVEPT", INSTRUCTION },
	{ "INVVPID", INSTRUCTION },
	{ "VMCALL", INSTRUCTION },
	{ "VMCLEAR", INSTRUCTION },
	{ "VMFUNC", INSTRUCTION },
	{ "VMLAUNCH", INSTRUCTION },
	{ "VMPTRLD", INSTRUCTION },
	{ "VMPTRST", INSTRUCTION },
	{ "VMREAD", INSTRUCTION },
	{ "VMRESUME", INSTRUCTION },
	{ "VMRESUME", INSTRUCTION },
	{ "VMWRITE", INSTRUCTION },
	{ "VMXOFF", INSTRUCTION },
	{ "VMXON", INSTRUCTION },
	{ "PREFETCHWT1", INSTRUCTION },
	{ "V4FMADDPS", INSTRUCTION },
	{ "V4FMADDSS", INSTRUCTION },
	{ "V4FNMADDPS", INSTRUCTION },
	{ "V4FNMADDSS", INSTRUCTION },
	{ "VEXP2PD", INSTRUCTION },
	{ "VEXP2PS", INSTRUCTION },
	{ "VGATHERPF0DPD", INSTRUCTION },
	{ "VGATHERPF0DPS", INSTRUCTION },
	{ "VGATHERPF0QPD", INSTRUCTION },
	{ "VGATHERPF0QPS", INSTRUCTION },
	{ "VGATHERPF1DPD", INSTRUCTION },
	{ "VGATHERPF1DPS", INSTRUCTION },
	{ "VGATHERPF1QPD", INSTRUCTION },
	{ "VGATHERPF1QPS", INSTRUCTION },
	{ "VP4DPWSSD", INSTRUCTION },
	{ "VP4DPWSSDS", INSTRUCTION },
	{ "VRCP28PD", INSTRUCTION },
	{ "VRCP28PS", INSTRUCTION },
	{ "VRCP28SD", INSTRUCTION },
	{ "VRCP28SS", INSTRUCTION },
	{ "VRSQRT28PD", INSTRUCTION },
	{ "VRSQRT28PS", INSTRUCTION },
	{ "VRSQRT28SD", INSTRUCTION },
	{ "VRSQRT28SS", INSTRUCTION },
	{ "VSCATTERPF0DPD", INSTRUCTION },
	{ "VSCATTERPF0DPS", INSTRUCTION },
	{ "VSCATTERPF0QPD", INSTRUCTION },
	{ "VSCATTERPF0QPS", INSTRUCTION },
	{ "VSCATTERPF1DPD", INSTRUCTION },
	{ "VSCATTERPF1DPS", INSTRUCTION },
	{ "VSCATTERPF1QPD", INSTRUCTION },
	{ "VSCATTERPF1QPS", INSTRUCTION },
};

struct AS_SyntaxPoint *as_asm_get_syntax(char *line) {
	if (line == NULL) {
		return NULL;
	}

	char c = 0;
	int x = 0;

	int org_len = strlen(line);

	struct AS_SyntaxPoint *head = (struct AS_SyntaxPoint *)malloc(sizeof(struct AS_SyntaxPoint));
	memset(head, 0, sizeof(struct AS_SyntaxPoint));
	struct AS_SyntaxPoint *current = head;
	struct AS_SyntaxPoint *prev = NULL;

	while ((c = *line) && x <= org_len) {
		current->length = 1;

		switch (c) {
		case ':': {
			current->color = COLON;

			if (prev != NULL && (prev->color == 0 || prev->color == INSTRUCTION)) {
				prev->color = LABEL;
			}

			break;
		}

		case '[':
		case ']': {
			current->color = SQUARE;

			break;
		}

		case '%':
		case '.': {
			current->color = MACRO;

			break;
		}

		case '$': {
			current->color = SYMBOL;

			break;
		}

		case ';': {
			current->color = COMMENT;
			current->x = x;
			current->length = strlen(line);

			goto finish;
		}

		default: {
			// Make sure the starting character is valid
			if (!isalnum(*line) && *line != '_') {
				break;
			}

			// Read string
			int i = 0;
			char n = *(line + i);
			char *start = line;

			while (isalnum(n) || n == '_') {
				i++;
				n = *(line + i);
			}

			char *extracted = (char *)malloc(i);
			strncpy(extracted, start, i);
			extracted[i] = 0;

			// Convert to uppercase
			for (int j = 0; j < i; j++) {
				extracted[j] = toupper(extracted[j]);
			}

			current->length = i;

			// Lookup the color
			#ifdef AS_GLIB_ENABLE
				struct keyword *keyword = g_hash_table_lookup(keywords_hash, (gpointer)extracted);

				if (keyword != NULL) {
					current->color = keyword->color;
				}
			#else
				for (int j = 0; j < (sizeof(keywords)/sizeof(keywords[0])); j++) {
					if (*extracted == *keywords[j].word && strcmp(extracted, keywords[j].word) == 0) {
						current->color = keywords[j].color;
						break;
					}
				}
			#endif

			// Check if string is apart of macro
			if (prev != NULL && prev->color == MACRO) {
				current->color = MACRO;
			}

			// Advance
			line += i - 1;

			// Memory Manage
			free(extracted);

			break;
		}
		}

		// Set properties of current link
		current->x = x;
		x += current->length;
		// Advance
		current->next = (struct AS_SyntaxPoint *)malloc(sizeof(struct AS_SyntaxPoint));
		memset(current->next, 0, sizeof(struct AS_SyntaxPoint));
		prev = current;
		current = current->next;

skip:
		line++;
	}

finish:

	return head;
}

void as_asm_backend_init(int i) {
	#ifdef AS_GLIB_ENABLE
		keywords_hash = g_hash_table_new(g_str_hash, g_str_equal);

		for (int i = 0; i < sizeof(keywords) / sizeof(keywords[0]); i++) {
			g_hash_table_insert(keywords_hash, (gpointer)keywords[i].word, (gpointer)&keywords[i]);
		}
	#endif

	as_ctx.syn_backends[i].extensions[0] = AS_SYNTAX_TYPE_ASM;
	as_ctx.syn_backends[i].get_syntax = as_asm_get_syntax;
}
